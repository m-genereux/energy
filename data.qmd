# Data

## Description

## Missing value analysis

### Load necessary libraries

```{r}
library(ggplot2)
library(dplyr)
library(tidyverse)
library(readr)
```

### Load data

```{r}
data1 <- read_csv('Table1.csv')
data2 <- read_csv('Table2.csv')
data4 <- read_csv('Table4.csv')
```

### Prepare data for missing values plot

```{r}
data1_plot <- data1 |>
  pivot_longer(cols = -Year) |>
  mutate(Missing = ifelse(is.na(value), 'Yes', 'No')) |>
  mutate(Year = as.character(Year))

data2_plot <- data2 |>
  pivot_longer(cols = -State) |>
  mutate(Missing = ifelse(is.na(value), 'Yes', 'No'))

data4_plot <- data4 |>
  pivot_longer(cols = -State) |>
  mutate(Missing = ifelse(is.na(value), 'Yes', 'No'))
```

### Missing values for each table

#### Table 11.1
```{r, fig.width = 10, fig.height = 5}
ggplot(data1_plot, aes(x = name, y = fct_rev(Year), fill = Missing)) +
  geom_tile(color = 'white') +
  scale_fill_viridis_d() +
  labs(title = 'Table 11.1 Missing Values',
       x = 'Column',
       y = 'Year') +
  theme_bw()
```

#### Table 11.2
```{r, fig.width = 10, fig.height = 12}
ggplot(data2_plot, aes(x = name, y = fct_rev(State), fill = Missing)) +
  geom_tile(color = 'white') +
  scale_fill_viridis_d() +
  labs(title = 'Table 11.2 Missing Values',
       x = 'Column',
       y = 'State') +
  theme_bw()
```

#### Table 11.4
```{r, fig.width = 24, fig.height = 12}
ggplot(data4_plot, aes(x = name, y = fct_rev(State), fill = Missing)) +
  geom_tile(color = 'white') +
  scale_fill_viridis_d() +
  labs(title = 'Table 11.2 Missing Values',
       x = 'Column',
       y = 'State') +
  theme_bw()
```
